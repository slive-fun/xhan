var U=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},T={},$={get exports(){return T},set exports(N){T=N}};(function(N,X){(function(D,A){N.exports=A()})(U,function(){return(()=>{var D={870:(m,l,f)=>{f.r(l),f.d(l,{createEndpoint:()=>_,expose:()=>M,proxy:()=>z,proxyMarker:()=>x,releaseProxy:()=>w,transfer:()=>b,transferHandlers:()=>p,windowEndpoint:()=>H,wrap:()=>t});const x=Symbol("Comlink.proxy"),_=Symbol("Comlink.endpoint"),w=Symbol("Comlink.releaseProxy"),g=Symbol("Comlink.thrown"),h=e=>typeof e=="object"&&e!==null||typeof e=="function",p=new Map([["proxy",{canHandle:e=>h(e)&&e[x],serialize(e){const{port1:o,port2:d}=new MessageChannel;return M(e,o),[d,[d]]},deserialize:e=>(e.start(),t(e))}],["throw",{canHandle:e=>h(e)&&g in e,serialize({value:e}){let o;return o=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[o,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}}]]);function M(e,o=self){o.addEventListener("message",function d(i){if(!i||!i.data)return;const{id:E,type:k,path:c}=Object.assign({path:[]},i.data),y=(i.data.argumentList||[]).map(P);let u;try{const v=c.slice(0,-1).reduce((S,q)=>S[q],e),O=c.reduce((S,q)=>S[q],e);switch(k){case 0:u=O;break;case 1:v[c.slice(-1)[0]]=P(i.data.value),u=!0;break;case 2:u=O.apply(v,y);break;case 3:u=z(new O(...y));break;case 4:{const{port1:S,port2:q}=new MessageChannel;M(e,q),u=b(S,[S])}break;case 5:u=void 0}}catch(v){u={value:v,[g]:0}}Promise.resolve(u).catch(v=>({value:v,[g]:0})).then(v=>{const[O,S]=R(v);o.postMessage(Object.assign(Object.assign({},O),{id:E}),S),k===5&&(o.removeEventListener("message",d),C(o))})}),o.start&&o.start()}function C(e){(function(o){return o.constructor.name==="MessagePort"})(e)&&e.close()}function t(e,o){return a(e,[],o)}function n(e){if(e)throw new Error("Proxy has been released and is not useable")}function a(e,o=[],d=function(){}){let i=!1;const E=new Proxy(d,{get(k,c){if(n(i),c===w)return()=>L(e,{type:5,path:o.map(y=>y.toString())}).then(()=>{C(e),i=!0});if(c==="then"){if(o.length===0)return{then:()=>E};const y=L(e,{type:0,path:o.map(u=>u.toString())}).then(P);return y.then.bind(y)}return a(e,[...o,c])},set(k,c,y){n(i);const[u,v]=R(y);return L(e,{type:1,path:[...o,c].map(O=>O.toString()),value:u},v).then(P)},apply(k,c,y){n(i);const u=o[o.length-1];if(u===_)return L(e,{type:4}).then(P);if(u==="bind")return a(e,o.slice(0,-1));const[v,O]=r(y);return L(e,{type:2,path:o.map(S=>S.toString()),argumentList:v},O).then(P)},construct(k,c){n(i);const[y,u]=r(c);return L(e,{type:3,path:o.map(v=>v.toString()),argumentList:y},u).then(P)}});return E}function r(e){const o=e.map(R);return[o.map(i=>i[0]),(d=o.map(i=>i[1]),Array.prototype.concat.apply([],d))];var d}const s=new WeakMap;function b(e,o){return s.set(e,o),e}function z(e){return Object.assign(e,{[x]:!0})}function H(e,o=self,d="*"){return{postMessage:(i,E)=>e.postMessage(i,d,E),addEventListener:o.addEventListener.bind(o),removeEventListener:o.removeEventListener.bind(o)}}function R(e){for(const[o,d]of p)if(d.canHandle(e)){const[i,E]=d.serialize(e);return[{type:3,name:o,value:i},E]}return[{type:0,value:e},s.get(e)||[]]}function P(e){switch(e.type){case 3:return p.get(e.name).deserialize(e.value);case 0:return e.value}}function L(e,o,d){return new Promise(i=>{const E=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.addEventListener("message",function k(c){c.data&&c.data.id&&c.data.id===E&&(e.removeEventListener("message",k),i(c.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:E},o),d)})}},162:function(m,l,f){var x=this&&this.__createBinding||(Object.create?function(t,n,a,r){r===void 0&&(r=a),Object.defineProperty(t,r,{enumerable:!0,get:function(){return n[a]}})}:function(t,n,a,r){r===void 0&&(r=a),t[r]=n[a]}),_=this&&this.__setModuleDefault||(Object.create?function(t,n){Object.defineProperty(t,"default",{enumerable:!0,value:n})}:function(t,n){t.default=n}),w=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(t!=null)for(var a in t)a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)&&x(n,t,a);return _(n,t),n};Object.defineProperty(l,"__esModule",{value:!0}),l.createDbWorker=void 0;const g=w(f(870));async function h(t){if(t.data&&t.data.action==="eval"){const n=new Int32Array(t.data.notify,0,2),a=new Uint8Array(t.data.notify,8);let r;try{r={ok:await C(t.data.request)}}catch(b){console.error("worker request error",t.data.request,b),r={err:String(b)}}const s=new TextEncoder().encode(JSON.stringify(r));a.set(s,0),n[1]=s.length,Atomics.notify(n,0)}}function p(t){if(t.tagName==="BODY")return"body";const n=[];for(;t.parentElement&&t.tagName!=="BODY";){if(t.id){n.unshift("#"+t.id);break}{let a=1,r=t;for(;r.previousElementSibling;)r=r.previousElementSibling,a++;n.unshift(t.tagName.toLowerCase()+":nth-child("+a+")")}t=t.parentElement}return n.join(" > ")}function M(t){return Object.keys(t)}async function C(t){if(console.log("dom vtable request",t),t.type==="select")return[...document.querySelectorAll(t.selector)].map(n=>{const a={};for(const r of t.columns)r==="selector"?a.selector=p(n):r==="parent"?n.parentElement&&(a.parent=n.parentElement?p(n.parentElement):null):r==="idx"||(a[r]=n[r]);return a});if(t.type==="insert"){if(!t.value.parent)throw Error('"parent" column must be set when inserting');const n=document.querySelectorAll(t.value.parent);if(n.length===0)throw Error(`Parent element ${t.value.parent} could not be found`);if(n.length>1)throw Error(`Parent element ${t.value.parent} ambiguous (${n.length} results)`);const a=n[0];if(!t.value.tagName)throw Error("tagName must be set for inserting");const r=document.createElement(t.value.tagName);for(const s of M(t.value))if(t.value[s]!==null){if(s==="tagName"||s==="parent")continue;if(s==="idx"||s==="selector")throw Error(`${s} can't be set`);r[s]=t.value[s]}return a.appendChild(r),null}if(t.type==="update"){const n=document.querySelector(t.value.selector);if(!n)throw Error(`Element ${t.value.selector} not found!`);const a=[];for(const r of M(t.value)){const s=t.value[r];if(r!=="parent"){if(r!=="idx"&&r!=="selector"&&s!==n[r]){if(console.log("SETTING ",r,n[r],"->",s),r==="tagName")throw Error("can't change tagName");a.push(r)}}else if(s!==p(n.parentElement)){const b=document.querySelectorAll(s);if(b.length!==1)throw Error(`Invalid target parent: found ${b.length} matches`);b[0].appendChild(n)}}for(const r of a)n[r]=t.value[r];return null}throw Error(`unknown request ${t.type}`)}g.transferHandlers.set("WORKERSQLPROXIES",{canHandle:t=>!1,serialize(t){throw Error("no")},deserialize:t=>(t.start(),g.wrap(t))}),l.createDbWorker=async function(t,n,a,r=1/0){const s=new Worker(n),b=g.wrap(s),z=await b.SplitFileHttpDatabase(a,t,void 0,r);return s.addEventListener("message",h),{db:z,worker:b,configs:t}}},432:function(m,l,f){var x=this&&this.__createBinding||(Object.create?function(w,g,h,p){p===void 0&&(p=h),Object.defineProperty(w,p,{enumerable:!0,get:function(){return g[h]}})}:function(w,g,h,p){p===void 0&&(p=h),w[p]=g[h]}),_=this&&this.__exportStar||function(w,g){for(var h in w)h==="default"||Object.prototype.hasOwnProperty.call(g,h)||x(g,w,h)};Object.defineProperty(l,"__esModule",{value:!0}),_(f(162),l)}},A={};function j(m){var l=A[m];if(l!==void 0)return l.exports;var f=A[m]={exports:{}};return D[m].call(f.exports,f,f.exports,j),f.exports}return j.d=(m,l)=>{for(var f in l)j.o(l,f)&&!j.o(m,f)&&Object.defineProperty(m,f,{enumerable:!0,get:l[f]})},j.o=(m,l)=>Object.prototype.hasOwnProperty.call(m,l),j.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})},j(432)})()})})($);const W=new URL(""+new URL("../assets/sqlite.worker-e48eea05.js",import.meta.url).href,self.location),B=new URL(""+new URL("../assets/sql-wasm-f71cee54.wasm",import.meta.url).href,self.location),I="/pb_data/data.db";let F=10*1024*1024;const G=T.createDbWorker([{from:"inline",config:{serverMode:"full",requestChunkSize:4096,url:I}}],W.toString(),B.toString(),F),Y=G.then(N=>N.db);export{Y as db};
